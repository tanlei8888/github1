<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <input type="button" name="" id="Btn" value="点我一下">
</body>
<script>
    let oinput = document.getElementById("Btn")
    oinput.addEventListener("click",() =>{
        Popup(300,300,"green","blue","true","true","alert","hello")
    })

    function Popup  (height, width, borderColor, backgroundColor, havemask, dragable, type, message=""){
    let oBody = document.body;
    let oDiv = createDiv(height, width, borderColor, backgroundColor, oBody);
    //兼容窗口
    window.addEventListener("resize", function (){
        resizeDiv(oDiv, width, height);
    });
    //判断参数
    if(havemask === "true"){
        //形成遮罩
        mask(oBody);
    }
    if(dragable === "true"){
        //弹出弹出框
        oDiv.onmousedown = function(event){
            let e = event || window.event;
            moveDiv(e, oDiv);
        }
    }
    //弹出弹出框类型
    typeDiv(type, oDiv,message)
}

// 设置弹出框css样式
let createDiv = (height, width, borderColor, backgroundColor, oBody) => {
    let div1 = document.createElement("div");
    let maxWidth = window.innerWidth;
    let maxHeight = window.innerHeight;
    div1.id = "popUp"
    div1.style.width = width + "px";
    div1.style.height = height + "px";
    div1.style.background = `${backgroundColor}`;
    div1.style.position = "fixed";
    div1.style.top = (maxHeight - height)/2 + "px";
    div1.style.left = (maxWidth - width)/2 + "px";
    div1.style.border = `1px solid ${borderColor}`;
    div1.style.zIndex = 1000;
    oBody.appendChild(div1);
    return div1;
}

// 窗口改变的时候改变弹出框的位置，保持一致居中
let resizeDiv = (oDiv, width, height) => {
    let maxWidth = window.innerWidth;
    let maxHeight = window.innerHeight;
    oDiv.style.top = (maxHeight - height)/2 + "px";
    oDiv.style.left = (maxWidth - width)/2 + "px";
}

// 设置遮罩
let mask = (parant) => {
    let maskDiv = document.createElement("div");
    maskDiv.id = "mask"
    maskDiv.style.width = "100%";
    maskDiv.style.height = "100%";
    maskDiv.style.position = "fixed";
    maskDiv.style.background = `rgba(0,0,0,0.3)`;
    maskDiv.style.top = 0;
    parant.appendChild(maskDiv);
}

// 设置拖曳
let moveDiv = (e, odiv) => {
    let diffX = e.clientX - odiv.offsetLeft;
    let diffY = e.clientY - odiv.offsetTop;
    document.onmousemove = function (e) {
        let moveX = e.clientX - diffX;
        let moveY = e.clientY - diffY;
        if(moveX < 0){
            moveX = 0;
        }else if(moveX > window.innerWidth - odiv.offsetWidth){
            moveX = window.innerWidth - odiv.offsetWidth;
        }
        if(moveY < 0){
            moveY = 0;
        }else if(moveY > window.innerHeight - odiv.offsetHeight) {
            moveY = window.innerHeight - odiv.offsetHeight;
        }
        odiv.style.top = moveY + "px";
        odiv.style.left = moveX + "px";
    }
    document.onmouseup = function (){
        document.onmousemove = null;
        document.onmouseup = null;
    }
}

// 设置弹窗的类型
let typeDiv = (type, odiv, message) => {
    let div3 = document.createElement("div");
    let otxt = document.createTextNode(message);
    div3.style.height = "calc(50% - 10px)";
    div3.style.backgroundColor = "#ffffff";
    div3.style.lineHeight = (odiv.offsetHeight - 20) / 2 + "px";
    div3.appendChild(otxt);
    odiv.appendChild(div3);
    let div4 = document.createElement("div");
    div4.style.height = (odiv.offsetHeight - 60) / 2 + "px";
    div4.style.lineHeight = (odiv.offsetHeight - 60) / 2 + "px";
    div4.style.textAlign = "center";
    odiv.appendChild(div4);
    if(type === "alert"){
        let but = document.createElement("input");
        but.id = "alertBut";
        but.type = "button";
        but.value = "确认";
        but.style.height = "25px";
        but.style.width = "50px"
        but.addEventListener("click", function(){
            alert("我不配")
            closePop();
        })
        div4.appendChild(but);
    }else if(type === "confirm"){
            let but = document.createElement("input");
            but.id = "popBut"
            but.type = "button";
            but.value = "确认";
            but.style.height = "25px";
            but.style.width = "50px"
            but.style.marginRight = odiv.offsetWidth / 5 + "px";
            div4.appendChild(but);
            but.addEventListener("click", function(){
                alert("感谢浏览")
                closePop();
            })
            let but1 = document.createElement("input");
            but1.type = "button";
            but1.value = "取消";
            but1.id = "popBut1"
            but1.style.height = "25px";
            but1.style.width = "50px"
            div4.appendChild(but1);
            but1.addEventListener("click", function(){
                closePop();
        })
    }
}

// 关闭提示框
let closePop = ()=>{
    let oBody = document.body
    let odiv = document.querySelector("#popUp")
    oBody.removeChild(odiv);
    let omask = document.querySelector("#mask");
    if(omask){
        oBody.removeChild(omask);
    }
}
</script>
</html>