<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Document</title>
		<style>
			h2 {
				width: 200px;
				margin: auto;
			}
			
			table {
				border: 1px solid black;
				width: 600px;
				margin: auto;
				text-align: center;
				border-collapse: collapse;
			}
			
			td,
			th {
				width: 150px;
				border: 1px solid black;
			}
			
			a {
				text-decoration: none;
			}
			
			#alertDiv {
				position: absolute;
				width: 300px;
				left: 42%;
				margin-top: 50px;
				border: 4px solid green;
				text-align: center;
				background-color: white;
			}
			
			#aX {
				margin-left: 91%;
			}
			
			#bg {
				position: absolute;
				background-color: rgba(0, 0, 0, 0.5);
				width: 100%;
				height: 100%;
				left: 0;
				top: 0;
				display: none;
			}
			
			#insertA {
				margin-left: 63%;
				margin-bottom: 1%;
			}
		</style>
	</head>

	<body>
		<div id="tableDiv">
			<div id="bg"></div>

			<p>
				<h2>人员信息表</h2></p>
			<button id="insertA">添加</button>
			<table id="tbl">
				<tr id="TR">
					<th>姓名&#8595; &#8593;</th>
					<th>年龄</th>
					<th>薪资</th>
					<th>操作</th>
				</tr>
			</table>
		</div>
		<div id="alertDiv">
			<a id="aX" href="#">X</a>
			<p><span id="spanTxt"></span>人员信息</p>
			姓名:<input type="text" name="" id="name">
			<br />
			<br /> 年龄:
			<input type="text" name="" id="age">
			<br />
			<br /> 薪资:
			<input type="text" name="" id="wages">
			<br />
			<br />
			<button name="" id="increase" value=""></button>
		</div>
	</body>
	<script>
		function init() {
			//获取表格元素
			let oTbl = document.getElementById("tbl");
			//获取tr标签元素
			let alertDiv = document.getElementById("alertDiv");
			//获取添加按钮的元素
			let ainsertA = document.getElementById("insertA");
			//获取遮罩层元素
			let Bg = document.getElementById("bg");
			//获取弹出框右上角关闭按钮X的元素
			let aaX = document.getElementById("aX");
			//获取确定按钮元素
			let aincreases = document.getElementById("increase");
			//获取弹出框里占位元素
			let spanTxt = document.getElementById("spanTxt");
			//获取所有的input输入框的元素
			let inputs = document.getElementsByTagName('input');
			//当前修改的事第几个tr
			let rowIndex = 0;
			//用来储存新增修改标签的id
			let tds = [];
			
			//绑定点击事件
			ainsertA.onclick = insert;
			aaX.onclick = closeEditDiv;
			aincreases.onclick=queding;

			//初始化时候隐藏弹出框
			closeEditDiv();
			//获取有多少input的元素id数组
			for(var i = 0; i < inputs.length; i++) {
				tds.push(inputs[i].id);
			}
			//修改触发的方法
			function update() {
				//调用弹出框显示，然后给占位元素赋值为   修改
				alertEditDiv('修改');
				//获取到当前的tr
				console.log(this)
				let aTr2 = this.parentNode.parentNode;
				//把当前tr的下标储存起来
				rowIndex = aTr2.rowIndex;
				//把tr中td的值赋值给弹出框的input标签
				for(var i = 0; i < (aTr2.children.length - 1); i++) {
					document.getElementById(tds[i]).value = aTr2.children[i].innerText;
				}
				//给按钮添加文本值
				aincreases.innerText = '修改';
			}
			//添加时候触发的方法
			function insert() {
				//调用弹出框显示，然后给占位元素赋值为   新增
				alertEditDiv('新增');
				//给按钮添加文本值
				aincreases.innerText = '确定';
			}
			//删除时候触发的方法
			function delet() {
				//获取到当前的tr
				let aTr2 = this.parentNode.parentNode;
				//获取到当前的tr的第一个儿子的文本值
				let name = aTr2.children[0].innerHTML;
				//组装alert信息
				let flag = confirm(`确定要删除 ${name} 的信息吗`);
				//确认即删除，否则则跳出
				if(flag) {
					aTr2.parentNode.removeChild(aTr2);
				}
			}
			//显示弹出框并且显示遮罩层
			function alertEditDiv(txt) {
				spanTxt.innerText = txt
				//显示遮罩层
				Bg.style.display = "block";
				//显示弹出框
				alertDiv.style.display = 'block';
			}
			//关闭弹出框并且关闭遮罩层
			function closeEditDiv() {
				//关闭弹出框时候把三个input的值置空
				document.getElementById("name").value = '';
				document.getElementById("age").value = '';
				document.getElementById("wages").value = '';
				//隐藏遮罩层
				Bg.style.display = "none"; 
				//隐藏弹出框
				alertDiv.style.display = 'none';
			}
			//校验必填项
			function checkInput(nAme,aGe,wAges){
				if(nAme != "" || aGe != "" || wAges != ""){
					return true;
				}else{
					return false;
				}
				
			}
			//确定按钮
			function queding() {
				if(aincreases.innerText == '确定') {
					//获取三个input的值
					let nAme = document.getElementById("name").value;
					let aGe = document.getElementById("age").value;
					let wAges = document.getElementById("wages").value;
					//必填校验，如果有一个标签为空都不让提交
					if(checkInput()) {
						let Tr = document.createElement("tr");
	
						let nameTd = document.createElement("td");
						let nameText = document.createTextNode(nAme);
						nameTd.appendChild(nameText);
	
						let ageTd = document.createElement("td");
						let ageText = document.createTextNode(aGe);
						ageTd.appendChild(ageText);
	
						let wagesTd = document.createElement("td");
						let wagesText = document.createTextNode(wAges);
						wagesTd.appendChild(wagesText);
	
						let aTd = document.createElement("td");
						let A = document.createElement("a");
						let A1 = document.createElement("a");
						A.href = "#";
						A1.href = "#";
						let aModify = document.createTextNode("修改 ");
						let aDelete = document.createTextNode("删除");
						
						//绑定修改事件
						A.onclick = update;
						//绑定删除事件
						A1.onclick = delet;
	
						A.appendChild(aModify);
						A1.appendChild(aDelete);
						aTd.appendChild(A);
						aTd.appendChild(A1);
	
						Tr.appendChild(nameTd);
						Tr.appendChild(ageTd);
						Tr.appendChild(wagesTd);
						Tr.appendChild(aTd);
						debugger
						oTbl.appendChild(Tr);
					}
				} else {
					//获取到当前点击修改的tr
					let aTr2 = oTbl.rows[rowIndex];
					//然后把修改后的数据覆盖tr中td的数据
					for(var i = 0; i < (aTr2.children.length - 1); i++) {
						aTr2.cells[i].innerText = document.getElementById(tds[i]).value;
					}
				}
				//关闭弹出框
				closeEditDiv();
			}
			
			
			
			
		}
		
		init();
	</script>

</html>